<div class="chart-container-wrapper" *ngIf="!loadingWorkordersFailed">
  <!-- spinner -->
  <div *ngIf="loading" class="chart-container">
    <div class="bootstrap-spinner-container-wrapper">
      <div class="bootstrap-spinner-container">
        <div class="bootstrap-spinner">
          <div
            #loadingSpinner
            class="spinner-border"
            style="width: 2rem; height: 2rem"
            role="status"
          ></div>
          <span class="loading-tag"><strong>Plotting Chart...</strong></span>
        </div>
      </div>
    </div>
  </div>

  <!-- canvas objects -->
  <!-- five sections one month -->
  <app-sections-per-month
    *ngIf="showSectionsPerMonthChart"
    class="chart-container"
    [workorders]="workorders"
    [sections]="sections"
    [month]="month"
    (chartPlotted)="updateChartPlotted($event)"
    (switchChart)="switchChart($event)"
  >
  </app-sections-per-month>

  <!-- four month comparison -->
  <app-four-months-period
    *ngIf="showFourMonthsPeriodChart"
    class="chart-container"
    [workorders]="workorders"
    [section]="section"
    (chartPlotted)="updateChartPlotted($event)"
    (switchChart)="switchChart($event)"
  ></app-four-months-period>

  <!-- one month broken down to its weeks -->
  <app-one-month-period
    *ngIf="showOneMonthPeriodChart"
    class="chart-container"
    [month]="month"
    [section]="section"
    [workorders]="workorders"
    (switchChart)="switchChart($event)"
  ></app-one-month-period>

  <!-- one week broken down to its days -->

  <!-- filter fields -->
  <div *ngIf="chartPlotted" class="filter-charts">
    <!-- select chart type -->
    <div class="select-chart-type">
      <div class="filter-charts-label">Change Chart Type</div>
      <div class="filter-chart-field">
        <mat-form-field class="filter-chart-form-field" appearance="outline">
          <mat-label>Select Chart</mat-label>
          <mat-select
            [(ngModel)]="chartType"
            #chartTypeField
            (selectionChange)="changeDisplayedChart(chartTypeField.value)"
          >
            <mat-option value="sections-one-month">
              Sections Per Month</mat-option
            >
            <mat-option value="section-four-months-period">
              Section Over Four Months</mat-option
            ><mat-option value="section-one-month-period">
              Section In One Month</mat-option
            ><mat-option
              *ngIf="showOneMonthPeriodChart"
              value="section-one-week-period"
            >
              Section In One Week</mat-option
            >
          </mat-select>
        </mat-form-field>
      </div>
    </div>

    <!-- filter charts -->
    <div class="filter-chart-parameters">
      <div class="filter-charts-label">Change Chart Values</div>

      <!-- select multiple sections -->
      <div *ngIf="showSectionsPerMonthChart" class="filter-chart-field">
        <mat-form-field class="filter-chart-form-field" appearance="outline">
          <mat-label>Change Sections</mat-label>
          <mat-select
            multiple
            #multipleSections
            [(ngModel)]="sections"
            (selectionChange)="updateSectionsToDisplay($event.value)"
          >
            <mat-select-trigger>
              {{
                multipleSections?.value
                  ? multipleSections.value[0]["formattedName"]
                  : ""
              }}
              <span
                *ngIf="multipleSections?.value?.length > 1"
                class="select-multiple-sections-trigger"
              >
                (+{{ multipleSections?.value?.length - 1 }}
                {{
                  multipleSections?.value?.length === 2 ? "other" : "others"
                }})</span
              >
            </mat-select-trigger>

            <mat-option
              *ngFor="let section of factorySections"
              [value]="section"
              >{{ section.name }}</mat-option
            >
          </mat-select>
        </mat-form-field>
      </div>

      <!-- filter sections -->
      <div
        class="filter-chart-field"
        *ngIf="showFourMonthsPeriodChart || showOneMonthPeriodChart"
      >
        <mat-form-field class="filter-chart-form-field" appearance="outline">
          <mat-label>Change Section</mat-label>
          <mat-select
            [(ngModel)]="section"
            #sectionsFilterField
            (selectionChange)="
              updateSectionToDisplay(sectionsFilterField.value)
            "
          >
            <mat-option
              *ngFor="let section of factorySections"
              value="{{ section.name }}"
              >{{ section.name }}</mat-option
            >
          </mat-select>
        </mat-form-field>
      </div>

      <!-- filter months -->
      <div
        *ngIf="showOneMonthPeriodChart || showSectionsPerMonthChart"
        class="filter-chart-field"
      >
        <mat-form-field class="filter-chart-form-field" appearance="outline">
          <mat-label>Change Month</mat-label>
          <mat-select
            [(ngModel)]="month"
            #monthsFilterField
            (selectionChange)="updateMonthToDisplay(monthsFilterField.value)"
          >
            <mat-option
              *ngFor="let month of months"
              value="{{ month.formattedName }}"
              >{{ month.name }}</mat-option
            >
          </mat-select>
        </mat-form-field>
      </div>
    </div>
  </div>
</div>

<!-- could not load workorders -->
<div *ngIf="loadingWorkordersFailed" class="chart-container">
  {{ indexingError ? indexingError : otherError ? otherError : fallbackError }}
</div>
